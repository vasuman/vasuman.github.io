<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title> 
Noise -  aleph_null 
 </title>
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom Feed"/>
    

    <link rel="stylesheet" href="/static/blog.css"/>
    
<link rel="stylesheet" href="/static/pygments.css">


    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-40829655-2', 'auto');
      ga('send', 'pageview');
    </script>
    
    
  </head>
  <body>
    <div id="header">
        <a href="/"><h1> aleph_null </h1></a>
        <h2> Apparently coherent </h2>
    </div>
    <nav>
      <ul>
        
        <li>
          <a href="/posts/index.html">Posts</a>
        </li>
        
        <li>
          <a href="/stuff/index.html">Stuff</a>
        </li>
        
        <li>
          <a href="http://www.varav.in/atom.xml">
            <img class="feed-icon" src="/static/feed.png" alt="Feed"/>
          </a>
      </ul>
    </nav>
    <div id="content">
      
    <article class="std-format">
        <div class="post-header">
          <h1>Noise</h1>
            <time datetime="2015-09-24">24 Sep 2015</time>
        </div>
        <h2>Procedural generation</h2>
<p>I recently came across
<a href="http://notch.tumblr.com/post/3746989361/terrain-generation-part-1">this</a>
article on procedural terrain generation in Minecraft, which was pretty
interesting. Procedural generation refers to the use of algorithms to generate
content. It allows a programmer to create large and diverse worlds with no
manual effort - the initial investment excluded of course. Most procedurally
generated things need some source of variation.  Having all your terrain look
the same will boar the players. This is where <strong>noise</strong> comes in. You can use
some form of pseudo-random noise to make the generated content look more organic
and natural.</p>
<h2>Perlin noise</h2>
<p><a href="#">Ken Perlin</a> developed Perlin noise and even won an Oscar for his
achievement.</p>
<p>The algorithm is pretty simple. First, you generate a 2D grid of random vectors.</p>
<div class="codehilite"><pre><span class="kr">const</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="nx">h</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">grid</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">// vector helper</span>
<span class="kd">function</span> <span class="nx">V</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">norm</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">r</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">/=</span> <span class="nx">r</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">/=</span> <span class="nx">r</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">randVec</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">V</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">pos</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span> <span class="o">*</span> <span class="nx">w</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">v</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">w</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">h</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">v</span> <span class="o">=</span> <span class="nx">randVec</span><span class="p">();</span>
        <span class="nx">v</span><span class="p">.</span><span class="nx">norm</span><span class="p">();</span>
        <span class="nx">grid</span><span class="p">[</span><span class="nx">pos</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>To <em>sample</em> any given point <code>(x, y)</code> you simply have to, calculate the dot
vector of the four nearest gradients.</p>
<div class="codehilite"><pre><span class="kr">const</span> <span class="nx">resX</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">resY</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sub</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">scale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">*=</span> <span class="nx">fx</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">*=</span> <span class="nx">fy</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">-=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">-=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">V</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">i</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">V</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">dotGradient</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// distance</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">i</span><span class="p">().</span><span class="nx">sub</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">pos</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">smooth</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">w</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">f</span><span class="p">)</span> <span class="o">*</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">f</span> <span class="o">*</span> <span class="nx">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sample</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">V</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
    <span class="nx">v</span><span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nx">resX</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">resY</span><span class="p">);</span>
    <span class="c1">// grid coordinates;</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="p">(</span><span class="o">~~</span><span class="nx">v</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span> <span class="o">%</span> <span class="nx">w</span><span class="p">,</span>
        <span class="nx">j</span> <span class="o">=</span> <span class="p">(</span><span class="o">~~</span><span class="nx">v</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="o">%</span> <span class="nx">h</span><span class="p">;</span>
    <span class="c1">// dot with corners</span>
    <span class="kd">var</span> <span class="nx">topLeft</span> <span class="o">=</span> <span class="nx">dotGradient</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">),</span>
        <span class="nx">bottomLeft</span> <span class="o">=</span> <span class="nx">dotGradient</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="nx">topRight</span> <span class="o">=</span> <span class="nx">dotGradient</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">j</span><span class="p">),</span>
        <span class="nx">bottomRight</span> <span class="o">=</span> <span class="nx">dotGradient</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="c1">// mixing factors</span>
    <span class="kd">var</span> <span class="nx">fX</span> <span class="o">=</span> <span class="nx">smooth</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">x</span> <span class="o">%</span> <span class="mi">1</span><span class="p">),</span>
        <span class="nx">fY</span> <span class="o">=</span> <span class="nx">smooth</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">y</span> <span class="o">%</span> <span class="mi">1</span><span class="p">);</span>
    <span class="c1">// interpolate</span>
    <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">fX</span><span class="p">,</span> <span class="nx">topLeft</span><span class="p">,</span> <span class="nx">topRight</span><span class="p">),</span>
        <span class="nx">bottom</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">fX</span><span class="p">,</span> <span class="nx">bottomLeft</span><span class="p">,</span> <span class="nx">bottomRight</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">fY</span><span class="p">,</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">bottom</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<h3>Terrain generation</h3>
<p>For 2D terrain generation a simple recipe.</p>
<h3>Animation</h3>
<h4>WebGL</h4>
<h2>Simplex noise</h2>
<h2>Fractal noise</h2>
    </article>

    </div>
    <footer>
      <address>
        <a href="mailto:vasumanar@gmail.com">Vasuman R</a>
      </address>
      <div id="accounts">
        <ul>
          
          <li><a href="https://github.com/vasuman">GitHub</a></li>
          
          
        </ul>
      </div>
      <div id="creds">
        Generated using, <a href="https://github.com/vasuman/glob">glob</a>
      </div>
    </footer>
  </body>
</html>